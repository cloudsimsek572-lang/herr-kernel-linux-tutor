<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herr Kernel - Linux Academy v3.2</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: black; color: #10b981; font-family: monospace; overflow: hidden; }
        .terminal-scroll::-webkit-scrollbar { width: 4px; }
        .terminal-scroll::-webkit-scrollbar-thumb { background: #064e3b; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, useRef } = React;

        const PENGUIN_ASCII = `
          .---.
         /     \\
        (  o o  )
        |   V   |
       / \\     / \\
      (   '._.'   )
       \\__/_\\__/
         [===]
        `;

        // Einfache Platzhalter f√ºr die Komponenten, damit alles in einer Datei l√§uft
        const Sidebar = ({ isOpen, onClose, leaderboard, currentScore }) => (
            <div className={`fixed inset-y-0 left-0 z-50 w-64 bg-zinc-950 border-r border-zinc-800 transform ${isOpen ? 'translate-x-0' : '-translate-x-full'} transition-transform duration-300 p-4`}>
                <button onClick={onClose} className="text-emerald-500 mb-4">‚úï Schlie√üen</button>
                <h2 className="text-white font-bold mb-2">LEADERBOARD</h2>
                <div className="text-xs text-zinc-400">Highscore: {currentScore}</div>
                <pre className="text-[10px] mt-4 text-emerald-700">
                    {leaderboard.length > 0 ? "Daten geladen..." : "Noch keine Eintr√§ge"}
                </pre>
            </div>
        );

        const App = () => {
            const [username, setUsername] = useState('');
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [history, setHistory] = useState([]);
            const [inputValue, setInputValue] = useState('');
            const [lives, setLives] = useState(3.0);
            const [score, setScore] = useState(0);
            const [isSidebarOpen, setIsSidebarOpen] = useState(false);

            const handleLogin = (e) => {
                e.preventDefault();
                if (username.trim()) {
                    setIsLoggedIn(true);
                    setHistory([{ type: 'system', content: PENGUIN_ASCII + "\\nGuten Tag, " + username.toUpperCase() + ".\\nW√§hle [1] f√ºr Training." }]);
                }
            };

            const handleCommand = (e) => {
                e.preventDefault();
                const cmd = inputValue.trim().toLowerCase();
                let response = "";

                // Know-how Datenbank f√ºr die Pr√ºfung
                const labs = [
                    { q: "Wie √§nderst du Rechte auf '755'?", a: "chmod 755" },
                    { q: "Befehl zum Stoppen eines Dienstes?", a: "systemctl stop" },
                    { q: "Wie beendest du Prozess 1234 sofort?", a: "kill -9 1234" },
                    { q: "Besitzer einer Datei auf 'admin' √§ndern?", a: "chown admin" },
                    { q: "Wie h√§ngst du Text an eine Logdatei an?", a: ">>" }
                ];

                if (cmd === '1') {
                    // W√§hlt eine zuf√§llige Pr√ºfungsfrage aus
                    const randomLab = labs[Math.floor(Math.random() * labs.length)];
                    response = "PR√úFUNG: " + randomLab.q;
                    window.currentAnswer = randomLab.a; // Merkt sich die Antwort kurzzeitig
                } else if (window.currentAnswer && cmd.includes(window.currentAnswer)) {
                    setScore(s => s + 200);
                    response = "[PASS] Beeindruckend. Du hast das System verstanden.";
                    window.currentAnswer = null;
                } else if (cmd === 'help') {
                    setLives(l => l - 0.5);
                    response = "[FAIL] Hilfe? In der Pr√ºfung bist du auf dich allein gestellt! (-0.5 Leben)";
                } else {
                    response = "Analysiere... Befehl nicht korrekt oder unbekannt. Versuch es erneut!";
                }

                setHistory(prev => [...prev, { type: 'user', content: cmd }, { type: 'teacher', content: response }]);
                setInputValue('');
            };
            const hearts = "‚ù§Ô∏è".repeat(Math.floor(lives)) + (lives % 1 !== 0 ? "üíî" : "");

            if (!isLoggedIn) {
                return (
                    <div className="flex items-center justify-center h-screen bg-black">
                        <form onSubmit={handleLogin} className="p-8 border border-zinc-800 bg-zinc-950 rounded">
                            <pre className="text-emerald-500 text-[10px] mb-4">{PENGUIN_ASCII}</pre>
                            <input 
                                className="w-full bg-black border border-zinc-800 p-2 text-emerald-500 mb-4 outline-none" 
                                placeholder="Username" 
                                value={username} 
                                onChange={e => setUsername(e.target.value)}
                            />
                            <button className="w-full bg-emerald-600 text-black font-bold py-2">LOGIN</button>
                        </form>
                    </div>
                );
            }

            return (
                <div className="h-screen flex flex-col p-4">
                    <Sidebar isOpen={isSidebarOpen} onClose={() => setIsSidebarOpen(false)} leaderboard={[]} currentScore={score} />
                    <header className="flex justify-between items-center border-b border-zinc-800 pb-2">
                        <button onClick={() => setIsSidebarOpen(true)}>‚ò∞</button>
                        <div className="text-xs text-right">
                            <div>{hearts}</div>
                            <div className="text-amber-500 font-bold">{score} PTS</div>
                        </div>
                    </header>
                    <div className="flex-1 overflow-y-auto terminal-scroll py-4 whitespace-pre-wrap">
                        {history.map((m, i) => (
                            <div key={i} className={m.type === 'user' ? "text-blue-400" : "text-emerald-500"}>
                                {m.type === 'user' ? `> ${m.content}` : m.content}
                            </div>
                        ))}
                    </div>
                    <form onSubmit={handleCommand} className="flex border-t border-zinc-800 pt-2">
                        <span className="text-emerald-800 mr-2">root@kernel:~#</span>
                        <input 
                            className="bg-transparent outline-none flex-1 text-white" 
                            value={inputValue} 
                            onChange={e => setInputValue(e.target.value)}
                            autoFocus
                        />
                    </form>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
